# LLM-DA è¿è¡Œç»“æœè¯´æ˜

## ğŸ“¥ **è¾“å…¥æ•°æ®**

### 1. åŸå§‹æ•°æ®é›†
- **ä½ç½®**: `datasets/icews14_tiny/`
- **å†…å®¹**: 
  - `train.txt` - 50æ¡è®­ç»ƒæ•°æ®
  - `valid.txt` - 10æ¡éªŒè¯æ•°æ®  
  - `test.txt` - 10æ¡æµ‹è¯•æ•°æ®
  - `entities.txt` - 7,128ä¸ªå®ä½“
  - `relations.txt` - 230ä¸ªå…³ç³»
  - å„ç§æ˜ å°„æ–‡ä»¶ (entity2id.json, relation2id.json, ts2id.json)

### 2. æ•°æ®æ ¼å¼
```
å®ä½“1 \t å…³ç³» \t å®ä½“2 \t æ—¶é—´æˆ³
Police_(Australia) \t Arrest,_detain,_or_charge_with_legal_action \t Women_(Australia) \t 2014-01-01
```

## ğŸ“¤ **è¾“å‡ºç»“æœ**

### 1. è§„åˆ™é‡‡æ ·ç»“æœ
- **ä½ç½®**: `sampled_path/icews14_tiny/`
- **æ–‡ä»¶**: 
  - `rules_name.json` - è§„åˆ™åç§°æ˜ å°„
  - `rules_id.json` - è§„åˆ™IDæ˜ å°„
  - `confidence.json` - è§„åˆ™ç½®ä¿¡åº¦

### 2. LLMç”Ÿæˆçš„è§„åˆ™
- **ä½ç½®**: `gen_rules_iteration/icews14_tiny/gpt-4o-mini-top-0-f-2-l-1/`
- **æ–‡ä»¶**: æ¯ä¸ªå…³ç³»å¯¹åº”ä¸¤ä¸ªæ–‡ä»¶
  - `å…³ç³»å.txt` - ç”Ÿæˆçš„æ—¶åºé€»è¾‘è§„åˆ™
  - `å…³ç³»å.query` - å‘é€ç»™LLMçš„æç¤ºè¯

### 3. è§„åˆ™ç¤ºä¾‹
**Make_statement.txt** å†…å®¹ï¼š
```
Sample 1 time:
1. Make_statement(X0,X1,T1) <- inv_Engage_in_diplomatic_cooperation(X0,X1,T0)
2. Make_statement(X0,X2,T2) <- inv_Criticize_or_denounce(X0,X1,T0) & Make_statement(X1,X2,T1)
```

### 4. æ¸…ç†åçš„è§„åˆ™
- **ä½ç½®**: `gen_rules_iteration/icews14_tiny/clean/rules/`
- **æ–‡ä»¶**: `å…³ç³»å_summarized_rules.txt`

## ğŸ“Š **å¦‚ä½•çœ‹æ•ˆæœ**

### 1. æŸ¥çœ‹ç”Ÿæˆçš„è§„åˆ™
```bash
# æŸ¥çœ‹æŸä¸ªå…³ç³»ç”Ÿæˆçš„è§„åˆ™
cat gen_rules_iteration/icews14_tiny/gpt-4o-mini-top-0-f-2-l-1/Make_statement.txt

# æŸ¥çœ‹æ‰€æœ‰ç”Ÿæˆè§„åˆ™çš„æ–‡ä»¶
ls gen_rules_iteration/icews14_tiny/gpt-4o-mini-top-0-f-2-l-1/*.txt
```

### 2. æŸ¥çœ‹è§„åˆ™è´¨é‡
```bash
# ç»Ÿè®¡ç”Ÿæˆäº†å¤šå°‘è§„åˆ™
find gen_rules_iteration/icews14_tiny/gpt-4o-mini-top-0-f-2-l-1/ -name "*.txt" -exec wc -l {} \;

# æŸ¥çœ‹è§„åˆ™å†…å®¹
head -10 gen_rules_iteration/icews14_tiny/gpt-4o-mini-top-0-f-2-l-1/Make_statement.txt
```

### 3. è¿è¡Œå®Œæ•´è¯„ä¼°
```bash
# è¿è¡Œæ¨ç†æµ‹è¯•
python3 reasoning.py -p copy_gpt-4o-mini-top-0-f-2-l-1 -d icews14_tiny

# è¿è¡Œæœ€ç»ˆè¯„ä¼°
python3 evaluate.py -d icews14_tiny -c 'llm_test_apply_all_conf_cands_r[1,2,3]_w0_score_12[0.1,0.5,\'TLogic\',0.0,0.01,0]_top_20_et_origin.json' --graph_reasoning_type TiRGN --rule_weight 0.9
```

## ğŸ¯ **è¯„ä¼°æŒ‡æ ‡**

### 1. è§„åˆ™è´¨é‡æŒ‡æ ‡
- **è§„åˆ™æ•°é‡**: æ¯ä¸ªå…³ç³»ç”Ÿæˆäº†å¤šå°‘æ¡è§„åˆ™
- **è§„åˆ™é•¿åº¦**: è§„åˆ™çš„é•¿åº¦ï¼ˆ1-hop, 2-hopç­‰ï¼‰
- **è§„åˆ™è¦†ç›–**: è¦†ç›–äº†å¤šå°‘ç§å…³ç³»

### 2. æ¨ç†æ•ˆæœæŒ‡æ ‡
- **Hit@1**: æ’åç¬¬1çš„å‡†ç¡®ç‡
- **Hit@10**: æ’åå‰10çš„å‡†ç¡®ç‡
- **MRR**: å¹³å‡å€’æ•°æ’å
- **MR**: å¹³å‡æ’å

## ğŸ“ˆ **å½“å‰çŠ¶æ€**

âœ… **å·²å®Œæˆ**:
- æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
- LLMè§„åˆ™ç”Ÿæˆ (460ä¸ªå…³ç³»)
- è§„åˆ™æ–‡ä»¶ä¿å­˜

âš ï¸ **éœ€è¦å®Œæˆ**:
- è§„åˆ™æ’åºå’Œç­›é€‰
- æ¨ç†æµ‹è¯•
- æœ€ç»ˆè¯„ä¼°

## ğŸ’¡ **ä¸‹ä¸€æ­¥**

1. è¿è¡Œè§„åˆ™æ’åº: `python3 rank_rule.py`
2. è¿è¡Œæ¨ç†æµ‹è¯•: `python3 reasoning.py`  
3. è¿è¡Œæœ€ç»ˆè¯„ä¼°: `python3 evaluate.py`
4. æŸ¥çœ‹è¯„ä¼°ç»“æœå’ŒæŒ‡æ ‡


# 1. è§„åˆ™æ’å
python3 rank_rule.py -p gpt-4o-mini-top-0-f-2-l-1 -d icews14_tiny

# 2. å€™é€‰æ¨ç†  
python3 reasoning.py -d icews14_tiny -r confidence.json -l 1 2 3 -p 8 --min_conf 0.01 --weight_0 0.5 --top_k 20

# 3. æœ€ç»ˆè¯„ä¼°
python3 evaluate.py -d icews14_tiny -c 'llm_test_apply_all_conf_cands_r[1,2,3]_w0_score_12[0.1,0.5,'\''TLogic'\'',0.0,0.01,0]_top_20_et_origin.json' --graph_reasoning_type TiRGN --rule_weight 0.9